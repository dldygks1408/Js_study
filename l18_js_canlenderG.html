<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="utf-8">
  <link rel="stylesheet" href="./css/l18_calendar.css">
  <title>js calendar</title>
</head>

<body>
  <h1>Îã¨Î†• ÎßåÎì§Í∏∞</h1>
  <h2>
    <button class="changeMonth" id="preMonth" type="button" value="2021-8"></button>
    <span id="toDate"></span>
    <button class="changeMonth" id="nextMonth" type="button" value="2021-10"></button>
  </h2>
  <article>
    <form class="insert_schedule" name="insertSchedule">
      <b id="printDay"></b>
      <label>
        <input type="time" name="registTime" value="09:00">
      </label>
      <label>
        <input type="text" name="registText" value="ÏùºÏñ¥ÎÇòÎùº">
      </label>
      <button id="scbtn" type="button" name="regist"> Ïä§ÏºÄÏ§Ñ Ï∂îÍ∞Ä</button>
    </form>
  </article>
  <hr>
  </article>
  <table id="calendarTable">
    <thead>
      <tr>
        <th>Ïùº</th>
        <th>Ïõî</th>
        <th>Ìôî</th>
        <th>Ïàò</th>
        <th>Î™©</th>
        <th>Í∏à</th>
        <th>ÌÜ†</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
      </tr>
      <tr>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
        <td>
          <div class="day_container">
            <h5 class="day"></h5>
            <ul class="schedule">
              <li></li>
              <li></li>
              <li></li>
              <li></li>
              <li></li>
            </ul>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</body>
<script>
  const d_2021_09 = {
    1: {
      610: 'ÏÑ∏Ïàò',
      730: 'Î∞•',
      800: 'Ïö¥Ï†Ñ'
    },
    2: {
      610: 'ÏÑ∏Ïàò',
      730: 'Î∞•',
      800: 'Ïö¥Ï†Ñ'
    }
  }
  console.log(d_2021_09[1][610]);
  const ulschedule = document.querySelectorAll("ul.schedule");
  const tdList = document.querySelectorAll("#calendarTable td");
  for (td of tdList) {
    td.onmouseenter = (event) => {
      event.target.querySelector(".schedule").style.visibility = "visible";
    }
    td.addEventListener("mouseleave", function(event) {
      event.target.querySelector(".schedule").style.visibility = "hidden";
    })
  }

  //new Date().getMonth() ÌòÑÏû¨ Îã¨Ïùò -1ÏùÑ Î∞òÌôòÌïúÎã§.(0~11)
  printCalendar(new Date().getMonth() + 1);
  //function(para,para="default") Íº≠ ÎßàÏßÄÎßâ ÌååÎùºÎØ∏ÌÑ∞Ïóê Í∏∞Î≥∏Í∞íÏùÑ Ï£ºÏÑ∏Ïöî

  //new Date().getYear() = 2000-1900: 100, 2021-1900: 121
  function printCalendar(paraMonth, paraYear = (new Date().getYear() + 1900)) {
    let dateMonth = paraMonth - 1; //Date()Îäî month Í∞Ä 0~11ÍπåÏßÄÎã§.
    //9Ïõî ÎßàÏßÄÎßâ Ïùº Íµ¨ÌïòÍ∏∞
    let lastDay = new Date(paraYear, dateMonth + 1, 0).getDate();
    //9ÏõîÏùò ÏãúÏûëÌïòÎäî ÏöîÏùº Íµ¨ÌïòÍ∏∞
    let firstDay = new Date(paraYear, dateMonth, 1).getDay();
    //Ï†ÑÎã¨Ïùò ÎßàÏßÄÎßâÎÇ† Íµ¨ÌïòÍ∏∞
    let lastMonth = new Date(paraYear, dateMonth, 0).getDate();
    //////////////////////////////////////////////////////////////////////
    document.getElementById("toDate").innerText = `${paraYear}. ${paraMonth}`;
    document.getElementById("nextMonth").innerText = `${paraYear+Math.floor(paraMonth/12)}. ${paraMonth%12+1}`;
    document.getElementById("nextMonth").value = `${paraYear+Math.floor(paraMonth/12)}-${paraMonth%12+1}`; //
    document.getElementById("preMonth").innerText = `${paraYear-(paraMonth==1 ? 1:0)}. ${paraMonth==1 ? 12:paraMonth-1}`;
    document.getElementById("preMonth").value = `${paraYear-(paraMonth==1 ? 1:0)}-${paraMonth==1 ? 12:paraMonth-1}`;

    //document.getElementById("toDate").innerText=new Date(paraYear,dateMonth);

    //ÌôúÏÑ±ÌôîÎêú Ìï¥Îãπ Ïõî Ï∂úÎ†•
    for (let i = firstDay, d = 1; i < lastDay + firstDay; i++) {
      tdList[i].querySelector(".day").innerText = d++;
      tdList[i].classList.add("active"); //ÌôúÏÑ±ÌôîÎêú td Ïä§ÌÉÄÏùº Ï∂îÍ∞Ä
      tdList[i].classList.remove("disabled"); //ÎπÑÌôúÏÑ±ÌôîÎêú td Ïä§ÌÉÄÏùº ÏÇ≠Ï†ú
    }

    //ÎπÑÌôúÏÑ±ÌôîÎêú Ï†ÑÎã¨Ïùò Ï∂úÎ†•
    for (let i = firstDay - 1; i >= 0; i--) {
      tdList[i].querySelector(".day").innerText = lastMonth--;
      tdList[i].classList.add("disabled"); //ÎπÑÌôúÏÑ±ÌôîÎêú td Ïä§ÌÉÄÏùº Ï∂îÍ∞Ä
      tdList[i].classList.remove("active"); //ÌôúÏÑ±ÌôîÎêú td Ïä§ÌÉÄÏùº ÏÇ≠Ï†ú
    }
    //ÎπÑÌôúÏÑ±ÌôîÎêú Îã§ÏùåÎã¨ Ï∂úÎ†•
    let nextMonth = firstDay + lastDay
    for (let i = nextMonth, num = 1; i <= tdList.length - 1; i++) {
      tdList[i].querySelector(".day").innerText = num++;
      tdList[i].classList.add("disabled"); //ÎπÑÌôúÏÑ±ÌôîÎêú td Ïä§ÌÉÄÏùº Ï∂îÍ∞Ä
      tdList[i].classList.remove("active"); //ÌôúÏÑ±ÌôîÎêú td Ïä§ÌÉÄÏùº ÏÇ≠Ï†ú
    }
    printSchedule();
    function printSchedule(time) {
      for (td of tdList) {
        td.addEventListener('click', function() {
          const dayText = this.querySelector('.day').innerText;
          let clickul = ulschedule[Number(dayText) + Number(firstDay - 1)]

          document.querySelector('#printDay').innerText = `${dayText}Ïùº`;
          d_2021_09[dayText] = {
            610: 'ÏÑ∏Ïàò'
          };

          let li_html = "";
          for (key in d_2021_09) {
            li_html += `<li>`;
            li_html += `${JSON.stringify(d_2021_09[key][time])}`;
            li_html += `</li>`;
          }
          clickul.innerHTML = li_html;
        })
      }
    }

    document.forms.insertSchedule.regist.onclick = function(event){
      let registForm = event.target.form;
      let textVal = registForm.registText.value;
      let timeVal = registForm.registTime.value.split(':');
      let regist_time = Number(timeVal[0]*60) + Number(timeVal[1]);
      console.log(regist_time);
      d_2021_09 [regist_time] = textVal;
      printSchedule(regist_time);
    }

  }

  // const d_0913 =
  //   {
  //     430:"Í∏∞ÏÉÅ",
  //     450:"ÌïôÏõê",
  //     1080:"Ìá¥Í∑º",
  //     1170:"Ïßë ÎèÑÏ∞©",
  //     1320:"Ï∑®Ïπ®"
  //   }
  // printSchedule();
  //
  // function printSchedule(){
  //   let li_html="";
  //   for(key in d_0913){
  //     li_html += `<li>`;
  //     li_html += `<b class='timeLeft'>`;
  //     li_html += `${ (Number.parseInt(key/60)+"").padStart(2,0)} : `;
  //     li_html += `${(Number.parseInt(key%60)+"").padStart(2,0)} `;
  //     li_html += `</b>`;
  //     li_html += `<span>`;
  //     li_html += `${d_0913[key]}`;
  //     li_html += `</span>`;
  //     li_html += `<button class='delete' value=${key} onclick='deleteScheldule(event)'>`;
  //     li_html += `üóë`;
  //     li_html += `</button>`;
  //     li_html += `</li>`;
  //     console.log(key);
  //   }
  //   document.querySelector('#memo ul.schedule').innerHTML = li_html;
  // }
  //
  // document.forms.insertSchedule.regist.onclick = function(event){
  //   let registForm = event.target.form;
  //   let textVal = registForm.registText.value;
  //   let timeVal = registForm.registTime.value.split(':');
  //   let regist_time = Number(timeVal[0]*60) + Number(timeVal[1]);
  //   d_0913 [regist_time] = textVal;
  //   printSchedule();
  // }

  //
  // //Î∏åÎùºÏö∞Ï†ÄÏóê Í∞úÏ≤¥Í∞Ä Î°úÎìú Îê†Îïå ÌïúÎ≤à Ïû¨Ï†ïÏùò ÌïúÎã§.
  // function deleteScheldule(event){
  //   delete d_0913[Number(event.target.value)];
  //   printSchedule();
  // }

  //buttonÏù∏ Îã¨ Î∞îÍæ∏Í∏∞Îßå onclickÏù¥Î≤§Ìä∏ Ïû¨Ï†ïÏùò
  document.querySelectorAll(".changeMonth[type=button]").forEach((item) => {
    //  item.onclick=function(){}
    item.addEventListener("click", (event) => {
      let yearMonthArr = event.target.value.split("-")
      printCalendar(Number(yearMonthArr[1]), Number(yearMonthArr[0]));
    });
  });
</script>

</html>
